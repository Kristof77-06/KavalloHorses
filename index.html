<!DOCTYPE html>
<html lang="hu">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Termékeink</title>

    <!-- Bootstrap CSS (CDN) -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Font Awesome ikonok (CDN) -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <!-- Saját stíluslapok -->
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mobilmenu.css" />

    <!-- Menü- és mobil kereső specifikus stílusok -->
    <style>
      /* ============================================================
         MENU PANEL STÍLUSOK
         - A panel külön testvér elemként legyen a header után.
         - Zárt állapot: translateX(-100%) + max-height: 0 (rejtett).
         - Nyitott állapot: translateX(0) + max-height = JS által beállított scrollHeight.
         ============================================================ */

      #menuPanel {
        box-sizing: border-box;
        width: 100%;
        display: block;                 /* helyet foglal a dokumentumban */
        position: relative;             /* ne legyen absolute/fixed */
        overflow: hidden;               /* animált max-height miatt */
        max-height: 0;                  /* alapból rejtve */
        transition: transform 320ms ease, max-height 320ms ease;
        transform: translateX(-100%);   /* teljesen balra eltolva (eredeti mozgás) */
        background: #222;
        border-bottom: 1px solid #2a2a2a;
        z-index: 50;
        will-change: transform, max-height;
      }

      /* Nyitott állapot: vizuális csúsztatás vissza, max-height-et JS állítja be */
      #menuPanel.open {
        transform: translateX(0);
      }

      /* Menü lista és linkek */
      #menuPanel .navbar-nav {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding: 12px 14px;
        margin: 0;
        list-style: none;
      }

      #menuPanel .nav-item { margin: 0; }

      #menuPanel .nav-link {
        display: block;
        width: 100%;
        padding: 10px 12px;
        color: #ffffff;
        text-decoration: none;
        border-radius: 6px;
        background: #1a1a1a;
        border: 1px solid rgba(255,255,255,0.04);
        transition: background 160ms ease, color 160ms ease;
      }

      #menuPanel .nav-link:hover,
      #menuPanel .nav-link:focus {
        background: #2a2a2a;
        color: #ffffff;
        outline: none;
      }

      #menuPanel #kosarDb {
        margin-left: 6px;
        color: #ffd;
        font-weight: 600;
      }

      @media (max-width: 768px) {
        #menuPanel .navbar-nav { padding: 10px; }
        #menuPanel .nav-link { padding: 12px 14px; font-size: 16px; }
      }

      /* pointer-events a aria alapján */
      #menuPanel[aria-hidden="true"] { pointer-events: none; }
      #menuPanel[aria-hidden="false"] { pointer-events: auto; }

      /* Fejléc sticky */
      header.site-header {
        position: sticky;
        top: 0;
        z-index: 10000;
        background: #0b0b0b;
        border-bottom: 1px solid #181818;
      }

      /* Mobil keresősáv: alapból rejtve, animálható megjelenés */
      #mobilKeresosav {
        max-height: 0;
        overflow: hidden;
        transition: max-height 240ms ease, padding 200ms ease;
        padding-top: 0;
        padding-bottom: 0;
        background: #0b0b0b;
        border-top: 1px solid #181818;
      }
      #mobilKeresosav.open {
        padding-top: 8px;
        padding-bottom: 12px;
      }
      #mobilKeresosav .form-control {
        background: #fff;
        color: #111;
        border: 1px solid #ccc;
        border-radius: 6px;
      }
      #mobilKeresosav .form-control::placeholder { color: #666; }
    </style>

    <!-- Modul logika, ha van -->
    <script type="module" src="main.js" defer></script>
  </head>
  <body>
    <!-- FEJLÉC ÉS NAVBAR -->
    <header class="site-header">
      <nav class="navbar navbar-expand-md navbar-dark bg-dark w-100">
        <div class="container-fluid d-flex flex-nowrap align-items-center">
          <!-- Desktop kereső (asztali nézetben látható) -->
          <form
            class="d-none d-sm-flex me-auto"
            role="search"
            onsubmit="event.preventDefault(); keresesInditasa();"
          >
            <input
              type="text"
              id="keresoMezo"
              class="form-control me-2 w-auto"
              placeholder="Keresés..."
            />
            <button type="submit" class="btn btn-outline-light">Keresés</button>
          </form>

          <!-- Mobil kereső gomb (kis képernyőn látható) -->
          <div class="d-sm-none d-flex justify-content-start px-3">
            <button
              class="btn btn-outline-light"
              id="mobilKeresoBtn"
              aria-controls="mobilKeresosav"
              aria-expanded="false"
              aria-label="Mobil keresősáv"
            >
              <i class="fa fa-search"></i>
            </button>
          </div>

          <!-- Menü gomb (saját toggle, nem Bootstrap collapse) -->
          <button
            class="navbar-toggler ms-auto"
            type="button"
            id="hamburgerBtn"
            aria-controls="menuPanel"
            aria-expanded="false"
            aria-label="Menü megnyitása"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
        </div>
      </nav>

      <!-- Mobil keresősáv (alapból rejtve) -->
      <div class="d-sm-none px-3" id="mobilKeresosav" aria-hidden="true">
        <input
          type="text"
          id="keresoMezoMobil"
          class="form-control my-2 w-100"
          placeholder="Írd be, amit keresel..."
        />
        <button class="btn btn-primary mb-3 w-100" id="mobilKeresesInditoBtn">
          Keresés indítása
        </button>
      </div>
    </header>

    <!-- MENÜPANEL: külön testvér elemként a header után -->
    <nav id="menuPanel" aria-hidden="true">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="Kezdolap.html">Kezdőlap</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="rolunk.html">Rólunk</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="index.html">Termékeink</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="kosar.html">
            <i class="fa fa-shopping-cart"></i>
            Kosár
            <span id="kosarDb">(0)</span>
          </a>
        </li>
      </ul>
    </nav>
    <!-- FŐ TARTALOM -->
    <main class="row">
      <header class="text-center col-lg-12 mt-3 mb-3">
        <h1>Termékeink</h1>
      </header>

      <aside id="szures" class="col-lg-12 mb-4 px-4">
        <div class="d-flex align-items-center justify-content-center">
          <label for="kategoriak" class="fw-bold me-3">Szűrés kategória szerint:</label>
          <select id="kategoriak" class="form-select w-auto">
            <option value="osszes">Összes</option>
            <option value="kiegészítők">Kiegészítők</option>
            <option value="egészség javító">Egészség javító</option>
            <option value="csomagok">Csomagok</option>
          </select>
        </div>
      </aside>

      <aside id="keres" class="col-lg-12 mb-3"></aside>
      <article class="col-lg-12"></article>

      <aside id="termekek" class="col-lg-12 px-4">
        <!-- Ide tölti be a main.js a termekekLISTA tartalmát -->
      </aside>

      <footer class="col-lg-12 text-center mt-4 bg-light py-4">
        <div class="container">
          <p class="mb-1">© 2025 Webshop - Minden jog fenntartva</p>
          <p class="mb-1">Kézzel készült termékek, szeretettel</p>
        </div>
      </footer>
    </main>

    <!-- Megtekintés modal -->
    <div
      class="modal fade"
      id="megtekintesModal"
      tabindex="-1"
      aria-labelledby="megtekintesModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header justify-content-start">
            <button type="button" class="btn btn-link text-dark" data-bs-dismiss="modal" aria-label="Bezárás">
              <i class="fa fa-arrow-left fa-lg"></i>
            </button>
            <h5 class="modal-title ms-2" id="megtekintesModalLabel">Termék megtekintése</h5>
          </div>
          <div class="modal-body" id="modalBody"></div>
          <div class="modal-footer d-none"></div>
        </div>
      </div>
    </div>

    <!-- Külső JS fájlok -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Javított menü és mobil kereső JS -->
    <script>
      (function () {
        const btn = document.getElementById('hamburgerBtn');
        const panel = document.getElementById('menuPanel');

        // Mobil kereső elemek
        const mobilKeresoBtn = document.getElementById('mobilKeresoBtn');
        const mobilKeresosav = document.getElementById('mobilKeresosav');
        const mobilInput = document.getElementById('keresoMezoMobil');
        const mobilKeresesInditoBtn = document.getElementById('mobilKeresesInditoBtn');

        // Biztonsági ellenőrzés
        if (!panel || !btn) return;

        /* ---------- MENÜ LOGIKA ---------- */
        function openPanel() {
          panel.classList.add('open');
          // A transform miatt vizuálisan bejön; maxHeight beállítása biztosítja, hogy a dokumentum is növekedjen.
          requestAnimationFrame(() => {
            panel.style.maxHeight = panel.scrollHeight + 'px';
          });
          panel.setAttribute('aria-hidden', 'false');
          btn.setAttribute('aria-expanded', 'true');
          btn.setAttribute('aria-label', 'Menü bezárása');
        }

        function closePanel() {
          if (!panel.classList.contains('open')) return;
          panel.style.maxHeight = panel.scrollHeight + 'px';
          requestAnimationFrame(() => {
            panel.style.maxHeight = '0px';
          });
          // Várunk a transition végéig, majd eltávolítjuk az .open osztályt, hogy a transform visszaálljon.
          setTimeout(() => {
            panel.classList.remove('open');
          }, 350);
          panel.setAttribute('aria-hidden', 'true');
          btn.setAttribute('aria-expanded', 'false');
          btn.setAttribute('aria-label', 'Menü megnyitása');
        }

        function toggleMenu(e) {
          e && e.preventDefault();
          if (panel.classList.contains('open')) closePanel(); else openPanel();
        }

        btn.addEventListener('click', toggleMenu);

        // ResizeObserver a dinamikus tartalomhoz
        if ('ResizeObserver' in window) {
          new ResizeObserver(() => {
            if (panel.classList.contains('open')) {
              panel.style.maxHeight = panel.scrollHeight + 'px';
            }
          }).observe(panel);
        }

        // Esc zárás
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape') {
            if (panel.classList.contains('open')) closePanel();
            if (mobilKeresosav && mobilKeresosav.classList.contains('open')) closeMobilKereso();
          }
        });

        /* ---------- MOBIL KERESŐ LOGIKA ---------- */
        function openMobilKereso() {
          if (!mobilKeresosav) return;
          mobilKeresosav.classList.add('open');
          requestAnimationFrame(() => {
            mobilKeresosav.style.maxHeight = mobilKeresosav.scrollHeight + 'px';
          });
          mobilKeresosav.setAttribute('aria-hidden', 'false');
          if (mobilKeresoBtn) mobilKeresoBtn.setAttribute('aria-expanded', 'true');
          // fókusz az inputra kis késleltetéssel, hogy az animáció ne szakítsa meg
          setTimeout(() => mobilInput && mobilInput.focus(), 120);
        }

        function closeMobilKereso() {
          if (!mobilKeresosav) return;
          mobilKeresosav.style.maxHeight = mobilKeresosav.scrollHeight + 'px';
          requestAnimationFrame(() => {
            mobilKeresosav.style.maxHeight = '0px';
          });
          mobilKeresosav.classList.remove('open');
          mobilKeresosav.setAttribute('aria-hidden', 'true');
          if (mobilKeresoBtn) mobilKeresoBtn.setAttribute('aria-expanded', 'false');
        }

        function toggleMobilKereso(e) {
          e && e.preventDefault();
          if (!mobilKeresosav) return;
          if (mobilKeresosav.classList.contains('open')) closeMobilKereso(); else openMobilKereso();
        }

        if (mobilKeresoBtn) mobilKeresoBtn.addEventListener('click', toggleMobilKereso);

        // Esc a mobil inputban
        if (mobilInput) {
          mobilInput.addEventListener('keydown', (ev) => {
            if (ev.key === 'Escape' && mobilKeresosav && mobilKeresosav.classList.contains('open')) {
              closeMobilKereso();
              mobilKeresoBtn && mobilKeresoBtn.focus();
            }
          });
        }

        // ResizeObserver frissítés mobil keresőhöz
        if ('ResizeObserver' in window && mobilKeresosav) {
          new ResizeObserver(() => {
            if (mobilKeresosav.classList.contains('open')) {
              mobilKeresosav.style.maxHeight = mobilKeresosav.scrollHeight + 'px';
            }
          }).observe(mobilKeresosav);
        }

        // Mobil keresés indító gomb (ha van keresesInditasa függvényed, hívd meg itt)
        if (mobilKeresesInditoBtn) {
          mobilKeresesInditoBtn.addEventListener('click', (e) => {
            e.preventDefault();
            // Ha van globális keresesInditasa() függvény, hívd meg:
            if (typeof keresesInditasa === 'function') {
              keresesInditasa();
            }
          });
        }
      })();
    </script>
  </body>
</html>