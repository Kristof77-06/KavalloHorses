<!DOCTYPE html>
<html lang="hu">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kavallo Horses – Termékeink</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

    <!-- Saját stíluslapok -->
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mobilmenu.css" />

    <!-- Modul logika -->
    <script type="module" src="main.js" defer></script>

    <style>
      /* Biztonsági alapok: fixed navbar miatt a tartalom ne takaródjon */
      body { margin: 0; padding-top: 72px; font-family: Arial, sans-serif; }
      .navbar { position: fixed; top: 0; left: 0; right: 0; z-index: 1050; background-color: #212529; }
      .nav-link { color: #fff; }
      .nav-link.active { font-weight: 600; }
      #kosarDb { font-weight: 600; margin-left: 6px; }
      /* Mobil keresősáv alap (kosar.html viselkedéshez) */
      #mobilKeresosav { display: none; }
    </style>
  </head>

  <body>
    <!-- EGYSÉGES FEJLÉC (kosar.html-hez igazítva) -->
    <header class="site-header">
      <nav class="navbar navbar-expand-sm navbar-dark w-100">
        <div class="container-fluid">
          <!-- Desktop kereső -->
          <form class="d-none d-sm-flex me-auto" role="search" id="desktopKeresoForm" onsubmit="event.preventDefault(); keresesInditasa();">
            <input type="text" id="keresoMezo" class="form-control me-2" placeholder="Keresés..." />
            <button type="submit" class="btn btn-outline-light">Keresés</button>
          </form>

          <!-- Mobil kereső gomb (ugyanaz, mint kosar.html) -->
          <div class="d-sm-none d-flex justify-content-start px-3">
            <button class="btn btn-outline-light" id="mobilKeresoBtn" onclick="toggleKeresosav()" aria-label="Mobil kereső">
              <i class="fa fa-search" aria-hidden="true"></i>
            </button>
          </div>

          <!-- Mobil kereső sáv (kosar.html viselkedés) -->
          <div id="mobilKeresosav" class="d-sm-none px-3" aria-hidden="true" style="display: none;">
            <input type="text" id="keresoMezoMobil" class="form-control my-2 w-100" placeholder="Írd be, amit keresel..." />
            <button class="btn btn-primary mb-3 w-100" id="mobilKeresesInditoBtn" onclick="keresesInditasa()">Keresés indítása</button>
          </div>

          <!-- Hamburger gomb -->
          <button class="navbar-toggler ms-auto" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar" aria-controls="mynavbar" aria-expanded="false" aria-label="Menü megnyitása" id="hamburgerBtn">
            <span class="navbar-toggler-icon"></span>
          </button>

          <!-- Menü elemek (egységes struktúra) -->
          <div class="collapse navbar-collapse" id="mynavbar">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item"><a class="nav-link" href="Kezdolap.html">Kezdőlap</a></li>
              <li class="nav-item"><a class="nav-link" href="rolunk.html">Rólunk</a></li>
              <li class="nav-item"><a class="nav-link" href="index.html">Termékeink</a></li>
              <li class="nav-item">
                <a class="nav-link d-flex align-items-center" href="kosar.html">
                  <i class="fa fa-shopping-cart me-1" aria-hidden="true"></i>
                  <span class="d-none d-md-inline">Kosár</span>
                  <span id="kosarDb">(0)</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- FŐ TARTALOM (kezdő rész) -->
    <main class="container-fluid">
      <div class="row">
        <header class="text-center col-12 mt-3 mb-3">
          <h1>Termékeink</h1>
        </header>

        <aside id="szures" class="col-12 mb-4 px-4">
          <div class="d-flex align-items-center justify-content-center">
            <label for="kategoriak" class="fw-bold me-3">Szűrés kategória szerint:</label>
            <select id="kategoriak" class="form-select w-auto">
              <option value="osszes">Összes</option>
              <option value="kiegeszitok">Kiegészítők</option>
              <option value="egeszseg javito">Egészség javító</option>
              <option value="csomagok">Csomagok</option>
            </select>
          </div>
        </aside>
        <aside id="keres" class="col-12 mb-3"></aside>
        <article class="col-12"></article>

        <!-- Termékek konténer -->
        <aside id="termekek" class="col-12 px-4">
          <!-- Ide tölti be a main.js a termekekLISTA tartalmát -->
        </aside>

        <!-- Lábléc -->
        <footer class="col-12 text-center mt-4 bg-light py-4">
          <div class="container">
            <p class="mb-1">© 2025 Webshop - Minden jog fenntartva</p>
            <p class="mb-1">Kézzel készült termékek, szeretettel</p>
          </div>
        </footer>
      </div>
    </main>

    <!-- Megtekintés modal -->
    <div class="modal fade" id="megtekintesModal" tabindex="-1" aria-labelledby="megtekintesModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header justify-content-start">
            <button type="button" class="btn btn-link text-dark" data-bs-dismiss="modal" aria-label="Bezárás">
              <i class="fa fa-arrow-left fa-lg"></i>
            </button>
            <h5 class="modal-title ms-2" id="megtekintesModalLabel">Termék megtekintése</h5>
          </div>
          <div class="modal-body" id="modalBody"></div>
          <div class="modal-footer d-none"></div>
        </div>
      </div>
    </div>

    <!-- Külső JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- Mobil kereső toggle és init (kosar.html viselkedésének másolata) -->
    <script>
      // Mobil kereső megjelenítése / elrejtése (kosar.html viselkedés)
      function toggleKeresosav() {
        const el = document.getElementById('mobilKeresosav');
        if (!el) return;
        el.style.display = (el.style.display === 'block') ? 'none' : 'block';
      }

      (function () {
        if (typeof bootstrap === 'undefined') return;

        const mynab = document.getElementById('mynavbar');
        const mobilCollapse = document.getElementById('mobilKeresosav');
        const hamburger = document.getElementById('hamburgerBtn');
        const mobilBtn = document.getElementById('mobilKeresoBtn');

        if (!mynab) return;

        // Menüpontokra kattintva bezárjuk a menüt és biztosítjuk a navigációt (mobilon is)
        mynab.querySelectorAll('a.nav-link[href]').forEach(link => {
          link.addEventListener('click', function () {
            const href = this.getAttribute('href');
            if (!href || href === '#' || href.startsWith('javascript:')) return;
            const menuInstance = bootstrap.Collapse.getInstance(mynab) || new bootstrap.Collapse(mynab, { toggle: false });
            if (mynab.classList.contains('show')) menuInstance.hide();
            setTimeout(() => {
              try {
                const targetUrl = new URL(href, location.href).href;
                if (location.href !== targetUrl) location.href = targetUrl;
              } catch (err) {
                // hagyjuk a normál kattintást
              }
            }, 200);
          }, { passive: true });
        });

        // Ha a mobil keresőt megnyitják, zárjuk a menüt; ha a menüt nyitják, elrejtjük a keresőt
        if (mobilBtn) {
          mobilBtn.addEventListener('click', function () {
            if (mynab.classList.contains('show')) {
              const menuInstance = bootstrap.Collapse.getInstance(mynab) || new bootstrap.Collapse(mynab, { toggle: false });
              menuInstance.hide();
            }
          }, { passive: true });
        }

        if (hamburger) {
          hamburger.addEventListener('click', function () {
            if (mobilCollapse && mobilCollapse.style.display === 'block') {
              mobilCollapse.style.display = 'none';
            }
          }, { passive: true });
        }

        // Fallback: ha nincs kosarDb, hozzuk létre egyszer
        if (!document.getElementById('kosarDb')) {
          const cartLink = document.querySelector('a[href="kosar.html"]');
          if (cartLink) {
            const span = document.createElement('span');
            span.id = 'kosarDb';
            span.className = 'ms-2';
            span.textContent = '(0)';
            cartLink.appendChild(span);
          }
        }
      })();
    </script>
  </body>
</html>